#include "engine/math.h"
#include "test/tester.h"


void vec3f_equals_returns_true_for_equal_vals() {
  // arrange
  Vec3f x_1 = {{{3.0f, 4.0f, 5.0f}}};
  Vec3f x_2 = {{{3.0f, 4.0f, 5.0f}}};

  // assert
  assert_that(vec3f_equals(x_1, x_2));

  test_success;
}

void vec3f_equals_returns_false_for_inequal_vals() {
  // arrange
  Vec3f x = {{{1.0f, 2.0f, 3.0f}}};
  Vec3f y = {{{3.0f, 2.0f, 1.0f}}};

  // assert
  assert_that(!vec3f_equals(x, y));

  test_success;
}

void vec3f_cross_returns_correct_for_basis_vectors() {
  // arrange
  Vec3f x = {{{1.0f, 0.0f, 0.0f}}};
  Vec3f y = {{{0.0f, 1.0f, 0.0f}}};
  Vec3f z = {{{0.0f, 0.0f, 1.0f}}};

  Vec3f mx = {{{-1.0f, 0.0f, 0.0f}}};
  Vec3f my = {{{0.0f, -1.0f, 0.0f}}};
  Vec3f mz = {{{0.0f, 0.0f, -1.0f}}};

  // act
  Vec3f c1 = vec3f_cross(x, y);
  Vec3f c2 = vec3f_cross(y, z);
  Vec3f c3 = vec3f_cross(z, x);

  Vec3f a1 = vec3f_cross(y, x);
  Vec3f a2 = vec3f_cross(z, y);
  Vec3f a3 = vec3f_cross(x, z);

  // assert
  assert_that(vec3f_equals(c1, z));
  assert_that(vec3f_equals(c2, x));
  assert_that(vec3f_equals(c3, y));

  assert_that(vec3f_equals(a1, mz));
  assert_that(vec3f_equals(a2, mx));
  assert_that(vec3f_equals(a3, my));
  
  test_success;
}

void vec3f_cross_returns_correct_for_arbitrary_vectors() {
  // arrange
  Vec3f x1 = {{{3.0f, 1.0f, 3.0f}}};
  Vec3f x2 = {{{-3.0f, 2.0f, 1.0f}}};
  Vec3f x3 = {{{0.0f, 4.0f, -2.0f}}};

  // act
  Vec3f y1 = vec3f_cross(x1, x2);
  Vec3f y2 = vec3f_cross(x2, x3);
  Vec3f y3 = vec3f_cross(x2, x2);

  // assert
  Vec3f ans1 = {{{-5.0, -12.0, 9.0}}};
  Vec3f ans2 = {{{-8.0, -6.0, -12.0}}};
  Vec3f ans3 = {{{0.0, 0.0, 0.0}}};
  assert_that(vec3f_equals(y1, ans1));
  assert_that(vec3f_equals(y2, ans2));
  assert_that(vec3f_equals(y3, ans3));

  test_success;
}

void vec3f_dot_returns_correct_for_arbitrary_vectors() {
  // arrange
  Vec3f x1 = {{{3.0f, 1.0f, 3.0f}}};
  Vec3f x2 = {{{-3.0f, 2.0f, 1.0f}}};
  Vec3f x3 = {{{0.0f, 4.0f, -2.0f}}};

  // act
  float y1 = vec3f_dot(x1, x2);
  float y2 = vec3f_dot(x2, x3);
  float y3 = vec3f_dot(x2, x2);

  // assert
  assert_that(y1 == -4);
  assert_that(y2 == 6 );
  assert_that(y3 == 14);

  test_success;
}

void test_vecmath() {
  run_test(vec3f_equals_returns_true_for_equal_vals);
  run_test(vec3f_equals_returns_false_for_inequal_vals);
  run_test(vec3f_cross_returns_correct_for_basis_vectors);
  run_test(vec3f_cross_returns_correct_for_arbitrary_vectors);

  run_test(vec3f_dot_returns_correct_for_arbitrary_vectors)
}
